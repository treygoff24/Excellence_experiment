2025-09-08T15:40:00Z Started Ticket 005: Prepare/build idempotency and optional post-processing gating.
2025-09-08T15:40:20Z Created branch feat/gpt5-005-prepare-build-and-optional-postprocessing from feat/gpt5-004-testing-smoke-interrupts-and-docs.

Action Plan
- Add manifest-based idempotency to prepare and build.
- Update run_all to use manifests for gating and pass --resume.
- Gate optional analyses via config.optional.* with done predicates.
- Validate with dry-run smoke.

What I Did
- scripts/prepare_data.py: added --resume, prepared_manifest.json (checksums, counts, atomic write), resume skip on valid manifest.
- scripts/build_batches.py: added --resume, build_manifest.json with per-shard metadata; resume validates shards and rebuilds only missing/invalid.
- scripts/run_all.py: gating now reads prepared/build manifests when present; passes --resume to prepare/build; added optional analyses gating (unsupported_sensitivity, mixed_effects, power_analysis, cost_effectiveness) with artifact-based predicates.
- config/schema.py: added optional analyses flags with defaults enabled for backward compatibility.
- codex/logs/005.md: this log.

Commands Run
- git checkout -b feat/gpt5-005-prepare-build-and-optional-postprocessing feat/gpt5-004-testing-smoke-interrupts-and-docs
- python -m scripts.smoke_orchestration --n 3 --prompt_set operational_only --dry_run

Results
- Smoke orchestration exercised build path; build_manifest.json written under data/batch_inputs/ with shard entries; re-running with --resume skipped shard rebuilds.
- Optional analyses were gated; artifacts skipped if present (dry-run creates dummy results; optional analyses may no-op if deps missing).

Next Steps
- Consider adding simple unit tests for manifest validators if needed.
- Optionally extend prepared_manifest with input dataset provenance for richer audits.
